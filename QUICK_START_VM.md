# MediaGenie VM å¿«é€Ÿéƒ¨ç½²æŒ‡å—

## ğŸš€ æœ€å¿«éƒ¨ç½²æ–¹å¼ï¼ˆ5 åˆ†é’Ÿï¼‰

### è™šæ‹Ÿæœºä¿¡æ¯
- **IP**: 13.92.133.12
- **ç”¨æˆ·**: azure
- **å¯†ç **: p@ssw0rd2025

---

## ğŸ“‹ éƒ¨ç½²æ­¥éª¤

### æ­¥éª¤ 1: SSH è¿æ¥åˆ° VM

æ‰“å¼€ PowerShell æˆ– CMDï¼Œè¿è¡Œï¼š

```bash
ssh azure@13.92.133.12
```

è¾“å…¥å¯†ç ï¼š`p@ssw0rd2025`

---

### æ­¥éª¤ 2: å…‹éš†é¡¹ç›®

åœ¨ VM ä¸Šè¿è¡Œï¼š

```bash
cd ~
git clone https://github.com/wyzgz0528/mediagenie-demo.git MediaGenie1001
cd MediaGenie1001
```

---

### æ­¥éª¤ 3: è¿è¡Œè‡ªåŠ¨éƒ¨ç½²è„šæœ¬

```bash
chmod +x deploy-vm-auto.sh
./deploy-vm-auto.sh
```

è„šæœ¬ä¼šè‡ªåŠ¨ï¼š
- âœ… å®‰è£… Docker å’Œ Docker Compose
- âœ… é…ç½®é˜²ç«å¢™
- âœ… åˆ›å»º .env æ–‡ä»¶
- âœ… æ„å»ºå¹¶å¯åŠ¨å®¹å™¨

**é¢„è®¡æ—¶é—´**: 5-10 åˆ†é’Ÿ

---

### æ­¥éª¤ 4: é…ç½®æ•°æ®åº“è¿æ¥

ç¼–è¾‘ .env æ–‡ä»¶ï¼š

```bash
nano .env
```

æ‰¾åˆ°è¿™ä¸€è¡Œï¼š

```env
DATABASE_URL=postgresql+asyncpg://dbadmin:YOUR_DB_PASSWORD@mediagenie-db-5428.postgres.database.azure.com:5432/mediagenie
```

å°† `YOUR_DB_PASSWORD` æ›¿æ¢ä¸ºå®é™…çš„æ•°æ®åº“å¯†ç ã€‚

ä¿å­˜å¹¶é€€å‡ºï¼š
- æŒ‰ `Ctrl + X`
- æŒ‰ `Y`
- æŒ‰ `Enter`

---

### æ­¥éª¤ 5: é‡å¯å®¹å™¨

```bash
docker-compose restart
```

---

### æ­¥éª¤ 6: é…ç½® Azure ç½‘ç»œå®‰å…¨ç»„ (NSG)

1. æ‰“å¼€ Azure Portal: https://portal.azure.com
2. æ‰¾åˆ°ä½ çš„è™šæ‹Ÿæœº
3. ç‚¹å‡»å·¦ä¾§èœå•çš„ **"ç½‘ç»œ"** æˆ– **"Networking"**
4. ç‚¹å‡» **"æ·»åŠ å…¥ç«™ç«¯å£è§„åˆ™"** æˆ– **"Add inbound port rule"**
5. æ·»åŠ ä»¥ä¸‹è§„åˆ™ï¼š

| åç§° | ç«¯å£ | åè®® | ä¼˜å…ˆçº§ |
|------|------|------|--------|
| Allow-Backend | 8000 | TCP | 1010 |
| Allow-Frontend | 8080 | TCP | 1020 |
| Allow-HTTP | 80 | TCP | 1030 |
| Allow-HTTPS | 443 | TCP | 1040 |

---

### æ­¥éª¤ 7: è®¿é—®åº”ç”¨ ğŸ‰

- **åç«¯ API**: http://13.92.133.12:8000
- **åç«¯æ–‡æ¡£**: http://13.92.133.12:8000/docs
- **å‰ç«¯åº”ç”¨**: http://13.92.133.12:8080

---

## ğŸ” éªŒè¯éƒ¨ç½²

### æ£€æŸ¥å®¹å™¨çŠ¶æ€

```bash
docker-compose ps
```

åº”è¯¥çœ‹åˆ°ä¸¤ä¸ªå®¹å™¨éƒ½åœ¨è¿è¡Œï¼š

```
NAME                    STATUS
mediagenie-backend      Up
mediagenie-frontend     Up
```

### æŸ¥çœ‹æ—¥å¿—

```bash
# æŸ¥çœ‹æ‰€æœ‰æ—¥å¿—
docker-compose logs -f

# åªæŸ¥çœ‹åç«¯æ—¥å¿—
docker-compose logs -f backend

# åªæŸ¥çœ‹å‰ç«¯æ—¥å¿—
docker-compose logs -f frontend
```

æŒ‰ `Ctrl + C` é€€å‡ºæ—¥å¿—æŸ¥çœ‹ã€‚

---

## ğŸ› ï¸ å¸¸ç”¨å‘½ä»¤

```bash
# é‡å¯æœåŠ¡
docker-compose restart

# åœæ­¢æœåŠ¡
docker-compose down

# å¯åŠ¨æœåŠ¡
docker-compose up -d

# é‡æ–°æ„å»ºå¹¶å¯åŠ¨
docker-compose up -d --build

# æŸ¥çœ‹å®¹å™¨çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹èµ„æºä½¿ç”¨
docker stats
```

---

## âŒ æ•…éšœæ’é™¤

### é—®é¢˜ 1: æ— æ³•è®¿é—®åº”ç”¨

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥å®¹å™¨æ˜¯å¦è¿è¡Œï¼š`docker-compose ps`
2. æ£€æŸ¥é˜²ç«å¢™ï¼š`sudo ufw status`
3. æ£€æŸ¥ Azure NSG æ˜¯å¦å¼€æ”¾ç«¯å£
4. æŸ¥çœ‹æ—¥å¿—ï¼š`docker-compose logs -f`

### é—®é¢˜ 2: æ•°æ®åº“è¿æ¥å¤±è´¥

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥ .env æ–‡ä»¶ä¸­çš„æ•°æ®åº“å¯†ç 
2. ç¡®ä¿ Azure PostgreSQL é˜²ç«å¢™å…è®¸ VM çš„ IP
3. é‡å¯å®¹å™¨ï¼š`docker-compose restart`

### é—®é¢˜ 3: å®¹å™¨æ— æ³•å¯åŠ¨

**è§£å†³æ–¹æ¡ˆ**:
```bash
# åœæ­¢æ‰€æœ‰å®¹å™¨
docker-compose down

# æ¸…ç†å¹¶é‡æ–°æ„å»º
docker-compose build --no-cache

# å¯åŠ¨
docker-compose up -d

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f
```

---

## ğŸ“š æ›´å¤šä¿¡æ¯

è¯¦ç»†éƒ¨ç½²æŒ‡å—è¯·æŸ¥çœ‹ï¼š`VM_DEPLOYMENT_GUIDE.md`

---

## âœ… éƒ¨ç½²æ£€æŸ¥æ¸…å•

- [ ] SSH è¿æ¥åˆ° VM æˆåŠŸ
- [ ] é¡¹ç›®ä»£ç å·²å…‹éš†
- [ ] è‡ªåŠ¨éƒ¨ç½²è„šæœ¬è¿è¡ŒæˆåŠŸ
- [ ] .env æ–‡ä»¶å·²é…ç½®æ•°æ®åº“å¯†ç 
- [ ] å®¹å™¨å·²é‡å¯
- [ ] Azure NSG å·²é…ç½®ç«¯å£è§„åˆ™
- [ ] å¯ä»¥è®¿é—®åç«¯ API (http://13.92.133.12:8000)
- [ ] å¯ä»¥è®¿é—®å‰ç«¯åº”ç”¨ (http://13.92.133.12:8080)

---

## ğŸ¯ ä¸‹ä¸€æ­¥

1. **é…ç½®åŸŸå** (å¯é€‰)
   - å°†åŸŸåæŒ‡å‘ 13.92.133.12
   - é…ç½® Nginx åå‘ä»£ç†
   - å®‰è£… SSL è¯ä¹¦

2. **æ€§èƒ½ä¼˜åŒ–**
   - é…ç½® Nginx ç¼“å­˜
   - å¯ç”¨ Gzip å‹ç¼©
   - é…ç½® CDN

3. **ç›‘æ§å’Œæ—¥å¿—**
   - è®¾ç½®æ—¥å¿—è½®è½¬
   - é…ç½®ç›‘æ§å‘Šè­¦
   - å®šæœŸå¤‡ä»½æ•°æ®

---

**ç¥éƒ¨ç½²é¡ºåˆ©ï¼** ğŸš€

