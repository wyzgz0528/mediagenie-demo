[supervisord]
nodaemon=true
user=root
logfile=/app/logs/supervisord.log
pidfile=/app/logs/supervisord.pid

[program:media-service]
command=python -m uvicorn main:app --host 127.0.0.1 --port 8001 --workers 2
directory=/app/backend
user=root
autostart=true
autorestart=true
redirect_stderr=true
stdout_logfile=/app/logs/media-service.log
stdout_logfile_maxbytes=50MB
stdout_logfile_backups=3

[program:marketplace-portal]
command=python app.py
directory=/app/marketplace-portal
user=root
autostart=true
autorestart=true
redirect_stderr=true
stdout_logfile=/app/logs/marketplace-portal.log
stdout_logfile_maxbytes=50MB
stdout_logfile_backups=3
environment=FLASK_APP=app.py,FLASK_ENV=production

[program:nginx]
command=nginx -g "daemon off;"
user=root
autostart=true
autorestart=true
redirect_stderr=true
stdout_logfile=/app/logs/nginx.log
stdout_logfile_maxbytes=50MB
stdout_logfile_backups=3